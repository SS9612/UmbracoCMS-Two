@using Umbraco.Cms.Web.Common.PublishedModels;
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage
@{
    Layout = null;
    var rootContent = Umbraco.ContentAtRoot();
    var siteSettings = rootContent.OfType<SiteSettings>().FirstOrDefault();

    var siteName = siteSettings?.SiteName ?? "Onatrix";
    var titleSuffix = siteSettings?.Value<string>("seoTitleSuffix");
    var explicitSeoTitle = Model.Value<string>("seoTitle");
    var baseTitle = !string.IsNullOrWhiteSpace(explicitSeoTitle)
        ? explicitSeoTitle
        : (Model.Level == 1 ? (Model.Name ?? siteName) : Model.Name ?? siteName);
    var documentTitle = !string.IsNullOrWhiteSpace(titleSuffix)
        ? $"{baseTitle} {titleSuffix}"
        : baseTitle;

    var seoDescription = Model.Value<string>("seoDescription");
    if (string.IsNullOrWhiteSpace(seoDescription))
    {
        seoDescription = siteSettings?.Value<string>("defaultSeoDescription") ?? string.Empty;
    }

    var seoImage = Model.Value<Umbraco.Cms.Core.Models.MediaWithCrops>("seoImage")
        ?? siteSettings?.Value<Umbraco.Cms.Core.Models.MediaWithCrops>("defaultSeoImage");

    var seoImageUrl = seoImage?.GetCropUrl(width: 1200, height: 630) ?? seoImage?.Url();

    var noIndex = Model.Value<bool>("seoNoIndex");

    var request = Context.Request;
    var absoluteUrl = $"{request.Scheme}://{request.Host}{request.PathBase}{request.Path}{request.QueryString}";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@documentTitle</title>
    @if (!string.IsNullOrWhiteSpace(seoDescription))
    {
        <meta name="description" content="@seoDescription" />
    }
    <meta property="og:title" content="@documentTitle" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="@absoluteUrl" />
    @if (!string.IsNullOrWhiteSpace(seoDescription))
    {
        <meta property="og:description" content="@seoDescription" />
    }
    @if (!string.IsNullOrWhiteSpace(seoImageUrl))
    {
        <meta property="og:image" content="@seoImageUrl" />
    }
    @if (noIndex)
    {
        <meta name="robots" content="noindex, nofollow" />
    }
    <link rel="canonical" href="@absoluteUrl" />

    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
          integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
          crossorigin="anonymous"
          referrerpolicy="no-referrer">

    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.css" />
    <link href="~/css/output.css" rel="stylesheet" asp-append-version="true" />
    <link href="~/css/swiper.css" rel="stylesheet" asp-append-version="true" />

</head>
<body>
    <partial name="Partials/Layout/_Topbar"/>
    <partial name="Partials/Layout/_Header" />

    @RenderBody()

    <partial name="Partials/Layout/_Footer" />

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.12/jquery.validate.unobtrusive.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.js"></script>
        <script src="~/js/form.js" ></script>
        <script src="~/js/swiper.js"></script>

        @RenderSection("Scripts", required: false)
</body>
</html>
